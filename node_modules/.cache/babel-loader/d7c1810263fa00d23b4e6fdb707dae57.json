{"ast":null,"code":"import _objectSpread from\"C:/Major Project/ProjectFrontend/pbms/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _slicedToArray from\"C:/Major Project/ProjectFrontend/pbms/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import axios from\"axios\";import jsPDF from\"jspdf\";import React,{useEffect}from\"react\";import{useState}from\"react\";import{Link}from\"react-router-dom\";import{toast}from\"react-toastify\";import{Button,Table}from\"reactstrap\";import base_url from\"../api/Service\";import{getToken}from\"../auth\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function AllBookings(){useEffect(function(){document.title=\"Booking Report || Property Booking Management System\";},[]);var _useState=useState([]),_useState2=_slicedToArray(_useState,2),bookings=_useState2[0],setBookings=_useState2[1];var getAllBookingFromServer=function getAllBookingFromServer(){axios.get(\"\".concat(base_url,\"/bookings/\"),{headers:{\"Authorization\":\"Bearer \".concat(getToken())}}).then(function(response){toast.success(\"Booking List has been Updated\",{toastId:\"loadedtoast\"});setBookings(response.data);},function(error){console.log(error);toast.error(\"Server Down\",{toastId:\"errortoast\"});});};useEffect(function(){getAllBookingFromServer();},[]);var printfunction=function printfunction(){var doc=new jsPDF();doc.text(\"Booking Details\",20,10);doc.autoTable({html:'#BookingTable'});doc.save('bookingdetails.pdf');toast.info(\"Booking Report Downloaded Successfully\",{toastId:\"downloadtoast\"});};var _useState3=useState({}),_useState4=_slicedToArray(_useState3,2),deleteBook=_useState4[0],setDeleteBook=_useState4[1];var deleteBooking=function deleteBooking(e){deleteDatafromServer(deleteBook);e.preventDefault();};var deleteDatafromServer=function deleteDatafromServer(data){axios.delete(\"\".concat(base_url,\"/bookings/\").concat(data.deletebookid),{headers:{\"Authorization\":\"Bearer \".concat(getToken())}}).then(function(response){toast.error(\"Booking Deleted\",{toastId:\"deletetoast\"});window.location.reload(false);},function(error){console.log(error);toast.info(\"You are not an Admin or Booking Not Found\",{toastId:\"deleteinfotoast\"});});};return/*#__PURE__*/_jsxs(\"div\",{className:\"ml-3\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"alert alert-info text-center w-100 p-3 ml-3\",role:\"alert\",children:/*#__PURE__*/_jsx(\"h2\",{children:\"Bookings Reports\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"my-custom-scrollbar table-wrapper-scroll-y ml-3\",children:/*#__PURE__*/_jsxs(Table,{className:\"table table-bordered table-striped mb-0 w-100\",id:\"BookingTable\",striped:true,children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"col-1\",scope:\"row\",children:\"Booking Id\"}),/*#__PURE__*/_jsx(\"th\",{className:\"col-3\",children:\"Customer\"}),/*#__PURE__*/_jsx(\"th\",{className:\"col-3\",children:\"Property\"}),/*#__PURE__*/_jsx(\"th\",{className:\"col-1\",children:\"Rate\"}),/*#__PURE__*/_jsx(\"th\",{className:\"col-1\",children:\"Booking Amount\"}),/*#__PURE__*/_jsx(\"th\",{className:\"col-2\",children:\"Booking Date\"}),/*#__PURE__*/_jsx(\"th\",{className:\"col-1\",children:\"Update\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:bookings.length>0?bookings.map(function(booking,i){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{className:\"text-center\",scope:\"row\",children:booking.bookID}),/*#__PURE__*/_jsx(\"td\",{children:booking.cname}),/*#__PURE__*/_jsx(\"td\",{children:booking.pname}),/*#__PURE__*/_jsx(\"td\",{children:booking.rate}),/*#__PURE__*/_jsx(\"td\",{children:booking.bookingAmount}),/*#__PURE__*/_jsx(\"td\",{children:booking.bookDate}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(Link,{to:\"/dashboard/updatebookings/\".concat(booking.bookID),children:/*#__PURE__*/_jsx(\"button\",{className:\"btn btn-outline-dark  ml-2\",children:\"Update\"})})})]},i);}):/*#__PURE__*/_jsx(\"tr\",{children:/*#__PURE__*/_jsx(\"td\",{className:\"text-center\",colSpan:7,children:\"No Bookings Found or Server Down\"})})})]})}),/*#__PURE__*/_jsx(\"div\",{className:\"container text-center mt-3 p-3\",children:/*#__PURE__*/_jsx(\"form\",{className:\"form-inline justify-content-center\",onSubmit:deleteBooking,action:\"\",method:\"post\",id:\"delete_booking_form\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control mx-3\",id:\"deletebookid\",placeholder:\"Enter Booking Id\",onChange:function onChange(e){setDeleteBook(_objectSpread(_objectSpread({},deleteBook),{},{deletebookid:e.target.value}));}}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"btn btn-outline-danger mx-3\",children:\"Delete Booking\"})]})})}),/*#__PURE__*/_jsx(\"div\",{className:\"container text-center p-3\",children:/*#__PURE__*/_jsx(Button,{color:\"info\",outline:true,onClick:printfunction,children:\"Download Booking Report\"})})]});}export default AllBookings;","map":{"version":3,"names":["axios","jsPDF","React","useEffect","useState","Link","toast","Button","Table","base_url","getToken","AllBookings","document","title","bookings","setBookings","getAllBookingFromServer","get","headers","then","response","success","toastId","data","error","console","log","printfunction","doc","text","autoTable","html","save","info","deleteBook","setDeleteBook","deleteBooking","e","deleteDatafromServer","preventDefault","delete","deletebookid","window","location","reload","length","map","booking","i","bookID","cname","pname","rate","bookingAmount","bookDate","target","value"],"sources":["C:/Major Project/ProjectFrontend/pbms/src/components/AllBookings.js"],"sourcesContent":["import axios from \"axios\";\r\nimport jsPDF from \"jspdf\";\r\nimport React, { useEffect } from \"react\";\r\nimport { useState } from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport { toast } from \"react-toastify\";\r\nimport { Button, Table } from \"reactstrap\";\r\nimport base_url from \"../api/Service\";\r\nimport { getToken } from \"../auth\";\r\n\r\nfunction AllBookings() {\r\n\r\n    useEffect(()=> {\r\n        document.title=\"Booking Report || Property Booking Management System\"\r\n    },[])\r\n\r\n    const [bookings, setBookings] = useState([])\r\n\r\n    const getAllBookingFromServer = () => {\r\n        axios.get(`${base_url}/bookings/`, {headers: {\"Authorization\" : `Bearer ${getToken()}`}}).then(\r\n            (response) => {\r\n                toast.success(\"Booking List has been Updated\", {\r\n                    toastId: \"loadedtoast\"\r\n                });\r\n                setBookings(response.data)\r\n            },\r\n            (error) => {\r\n                console.log(error);\r\n                toast.error(\"Server Down\", {\r\n                    toastId: \"errortoast\"\r\n                });\r\n            }\r\n        );\r\n    };\r\n\r\n    useEffect(() => {\r\n        getAllBookingFromServer();\r\n    }, [])\r\n\r\n    const printfunction = () => {\r\n        const doc = new jsPDF()\r\n        doc.text(\"Booking Details\", 20, 10)\r\n        doc.autoTable({ html: '#BookingTable' })\r\n        doc.save('bookingdetails.pdf')\r\n        toast.info(\"Booking Report Downloaded Successfully\", {\r\n            toastId: \"downloadtoast\"\r\n        })\r\n    }\r\n\r\n    const [deleteBook, setDeleteBook] = useState({})\r\n\r\n    const deleteBooking = (e) => {\r\n        deleteDatafromServer(deleteBook);\r\n        e.preventDefault();\r\n    }\r\n\r\n    const deleteDatafromServer = (data) => {\r\n        axios.delete(`${base_url}/bookings/${data.deletebookid}`, {headers: {\"Authorization\" : `Bearer ${getToken()}`}}).then(\r\n            (response) => {\r\n                toast.error(\"Booking Deleted\", {\r\n                    toastId: \"deletetoast\"\r\n                })\r\n                window.location.reload(false);\r\n            },\r\n            (error) => {\r\n                console.log(error);\r\n                toast.info(\"You are not an Admin or Booking Not Found\", {\r\n                    toastId: \"deleteinfotoast\"\r\n                })\r\n            }\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div className=\"ml-3\">\r\n            <div className=\"alert alert-info text-center w-100 p-3 ml-3\" role=\"alert\">\r\n                <h2>Bookings Reports</h2>\r\n            </div>\r\n            <div className=\"my-custom-scrollbar table-wrapper-scroll-y ml-3\">\r\n            <Table className=\"table table-bordered table-striped mb-0 w-100\" id=\"BookingTable\" striped >\r\n                    <thead>\r\n                        <tr>\r\n                            <th className=\"col-1\" scope=\"row\">Booking Id</th>\r\n                            <th className=\"col-3\">Customer</th>\r\n                            <th className=\"col-3\">Property</th>\r\n                            <th className=\"col-1\">Rate</th>\r\n                            <th className=\"col-1\">Booking Amount</th>\r\n                            <th className=\"col-2\">Booking Date</th>\r\n                            <th className=\"col-1\">Update</th>\r\n\r\n                        </tr>\r\n                    </thead>\r\n                    <tbody>\r\n                        {\r\n                            bookings.length > 0 ? bookings.map((booking, i) => (\r\n                                <tr key={i}>\r\n                                    <th className=\"text-center\" scope=\"row\">{booking.bookID}</th>\r\n                                    <td>{booking.cname}</td>\r\n                                    <td>{booking.pname}</td>\r\n                                    <td>{booking.rate}</td>\r\n                                    <td>{booking.bookingAmount}</td>\r\n                                    <td>{booking.bookDate}</td>\r\n                                    <td><Link to={`/dashboard/updatebookings/${booking.bookID}`}><button className=\"btn btn-outline-dark  ml-2\">Update</button></Link></td>\r\n                                </tr>\r\n                            )) : <tr><td className=\"text-center\" colSpan={7}>No Bookings Found or Server Down</td></tr>\r\n                        }\r\n                    </tbody>\r\n                </Table>\r\n                </div>\r\n\r\n                <div className=\"container text-center mt-3 p-3\">\r\n                <form className=\"form-inline justify-content-center\" onSubmit={deleteBooking} action=\"\" method=\"post\" id=\"delete_booking_form\">\r\n                    <div className=\"form-group\">\r\n                        <input type=\"text\" className=\"form-control mx-3\" id=\"deletebookid\" placeholder=\"Enter Booking Id\" onChange={(e) => {\r\n                            setDeleteBook({ ...deleteBook, deletebookid: e.target.value })\r\n                        }} />\r\n                        <button type=\"submit\" className=\"btn btn-outline-danger mx-3\">Delete Booking</button>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n\r\n            <div className=\"container text-center p-3\">\r\n                <Button color=\"info\" outline onClick={printfunction}>Download Booking Report</Button>\r\n            </div>\r\n\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default AllBookings"],"mappings":"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"},"metadata":{},"sourceType":"module"}